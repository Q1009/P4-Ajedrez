{% extends "base.html.j2" %}

{% block title %}Liste des tournois{% endblock %}

{% block content %}
<h2>Liste des tournois</h2>

{% if tournaments %}
<div class="table-card">
    <table class="info-table" aria-describedby="tournois-table">
        <thead>
            <tr>
                <th>Statut</th>
                <th>Nom</th>
                <th>Lieu</th>
                <th>Date de début</th>
                <th>Date de fin</th>
                <th>Joueurs</th>
                <th>Tours</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            {% for tournament in tournaments|sort(attribute='status, start_date') %}
            <tr>
                <td>{{ tournament.status | default('—') }}</td>
                <td>{{ tournament.name | default('—') }}</td>
                <td>{{ tournament.location | default('—') }}</td>
                <td>{{ tournament.start_date | default('—') }}</td>
                <td>{{ tournament.end_date | default('—') }}</td>

                <td>
                    {# lien cliquable vers la liste des joueurs du tournoi #}
                    {% if tournament.players is defined and tournament.players %}

                        <a href="./{{tournament.tournament_id}}_players.html"
                           class="badge-small" title="Voir les joueurs ({{ tournament.players|length }})">
                            {{ tournament.players|length }} joueurs</a>
                    {% else %}
                        <a href="./{{tournament.tournament_id}}_players.html"
                           class="badge-small" title="Voir les joueurs">0 joueurs</a>
                    {% endif %}
                </td>

                <td>
                    {# lien cliquable vers les tours/rounds du tournoi #}
                    {% if tournament.rounds is defined and tournament.rounds %}
                        <a href="./{{tournament.tournament_id}}_rounds.html"
                           class="badge-small" title="Voir les tours ({{ tournament.rounds|length }})">
                            {{ tournament.rounds|length }} tours</a>
                    {% else %}
                        <a href="./{{tournament.tournament_id}}_rounds.html"
                           class="badge-small" title="Voir les tours">0 tours</a>
                    {% endif %}
                </td>

                <td>{{ tournament.description | default('—') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="table-footer">
        <div class="pager">
            {# pagination placeholder — adapter côté contrôleur si besoin #}
            {% if pagination %}
                {% if pagination.prev %}
                    <a class="page-btn" href="/tournament/previous.html">«</a>
                {% endif %}
                <span class="muted">Page {{ pagination.page }} / {{ pagination.pages }}</span>
                {% if pagination.next %}
                    <a class="page-btn" href="/tournament/next.html">»</a>
                {% endif %}
            {% endif %}
        </div>
        <div class="controls">
            <a class="btn" href="/tournament/create.html">Créer un tournoi</a>
        </div>
    </div>
</div>

{% else %}
    <div class="empty-state">
        <p>Aucun tournoi trouvé.</p>
        <p><a class="btn" href="/tournament/create.html">Créer un tournoi</a></p>
    </div>
{% endif %}
{% endblock %}